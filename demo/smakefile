#----------------------------------------------------------
# SAGE demos makefile
# Fabrice Labrador <fabrice.labrador@gmail.com>
# V2.0 September 2021
#----------------------------------------------------------

# Build options
OPT=CPU=68040 IDIR=libinclude: MATH=68882 NOICONS
LIB=/lib/sage.lib

# Files
EXE=dragon fire_effect troll odysseus runner blood cube sotb mandelbrot effect engine sonic

# Build all demos
all: $(EXE) cleanobj

mandelbrot: mandelbrot.c $(LIB)
  sc LINK mandelbrot.c $(OPT) $(LIB)

fire_effect: fire_effect.c $(LIB)
  sc LINK fire_effect.c $(OPT) $(LIB)

cube: cube/mapcube.c cube/flatcube.c $(LIB)
#  sc LINK cube/mapcube.c $(OPT) $(LIB) DATA=far
  sc LINK cube/flatcube.c $(OPT) $(LIB) DATA=far

dragon: dragon/dragon_crown.c dragon/dragon_crown.h $(LIB)
  sc LINK dragon/dragon_crown.c $(OPT) $(LIB)

troll: troll/troll_run.c $(LIB)
  sc LINK troll/troll_run.c $(OPT) $(LIB)

odysseus: odysseus/odysseus.c $(LIB)
  sc LINK odysseus/odysseus.c $(OPT) $(LIB)

runner: runner/runner.c $(LIB)
  sc LINK runner/runner.c $(OPT) $(LIB) DATA=far

sotb: sotb/sotb_ehanced.c $(LIB)
  sc LINK sotb/sotb_ehanced.c $(OPT) $(LIB)

engine: engine/engine.c engine/entity.c engine/skybox.c engine/camera.c engine/terrain.c $(LIB)
  sc LINK engine/camera.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK engine/entity.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK engine/skybox.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK engine/terrain.c $(OPT) $(LIB) CODE=far DATA=fo
  sc LINK engine/engine.c $(OPT) $(LIB) CODE=far DATA=far

sonic: sonic/sonic.c $(LIB)
  sc LINK sonic/sonic.c $(OPT) $(LIB)

blood: blood/blood.c blood/blood.h blood/blood_engine.c blood/blood_engine.h blood/blood_control.c blood/blood_control.h $(LIB)
  sc LINK blood/blood.c blood/blood_engine.c blood/blood_control.c $(OPT) $(LIB) CODE=far DATA=far

# Ports of classical effects
effect: effect/plasma.c effect/tunnel.c effect/rotozoom.c effect/voxel.c $(LIB)
  sc LINK effect/plasma.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK effect/tunnel.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK effect/rotozoom.c $(OPT) $(LIB) CODE=far DATA=far
  sc LINK effect/voxel.c $(OPT) $(LIB) CODE=far DATA=far

# Clean files
clean: cleanobj cleandragon cleanrunner cleanblood cleansotb cleantroll cleanodysseus cleaneffect cleancube cleanengine
  @echo "** Clean complete **"

cleanobj:
  -@delete \#?.o
  -@delete \#?.lnk

cleandragon:
  -@delete dragon/\#?.o
  -@delete dragon/\#?.lnk

cleanrunner:
  -@delete runner/\#?.o
  -@delete runner/\#?.lnk

cleanblood:
  -@delete blood/\#?.o
  -@delete blood/\#?.lnk

cleansotb:
  -@delete sotb/\#?.o
  -@delete sotb/\#?.lnk

cleantroll:
  -@delete troll/\#?.o
  -@delete troll/\#?.lnk

cleanodysseus:
  -@delete odysseus/\#?.o
  -@delete odysseus/\#?.lnk

cleaneffect:
  -@delete effect/\#?.o
  -@delete effect/\#?.lnk

cleancube:
  -@delete cube/\#?.o
  -@delete cube/\#?.lnk
  
cleanengine:
  -@delete engine/\#?.o
  -@delete engine/\#?.lnk
